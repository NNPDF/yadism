.. _theory-sv:

Scale Variations
================

The coefficient functions may depend on a factorization scale :math:`\mu_F^2`
and on a renormalization scale :math:`\mu_R^2`. Both scales are unphysical and
enter via a |RGE|, i.e. the full object is independent on the specific choice.

Origin
------

The **factorization scale** is a relic of the collinear factorization and thus
related to the |PDF| scheme. It can be seen as an infra-red cut-off that
separates the perturbative hard matrix element and the non-perturbative |PDF|.
The explicit dependence on :math:`\mu_F^2` is generated by convolutions of
splitting functions with lower order coefficient functions
:cite:`AbdulKhalek:2019ihb,nnlo-sv-singlet`.

The **renormalization scale** is a relic of the Lagrange renormalization
procedure and thus related to the coupling scheme. It can be seen as an
ultra-violet cut-off that separates the perturbative hard matrix element and the
running coupling, that resums a specific class of terms. The explicit dependence
on :math:`\mu_R^2` is generated by inserting the |RGE|, i.e. the beta function,
into the expanded coefficient functions :cite:`AbdulKhalek:2019ihb,nnlo-sv-singlet`.

Description
-----------

Following a more in depth description about the structure of the scale
variations in the theory.
This is really decoupled from the process itself, and it has been used as a
guidance for the implementation itself, whose details are instead described in
the :ref:`corresponding technical section <implement-sv>`.

The most basic manifestation of scale variations is that:

- PDFs are always evaluated at the factorization scale :math:`\mu_F` (and this
  is a source of scale variations even at |LO|)
- :math:`\alpha_s` is always evaluated at the renormalization scale
  :math:`\mu_R` (and this is a source of scale variations already at |NLO|)

Actually the scale variations have also a non-trivial impact on the coefficient
function expressions (starting at |NLO| for factorization scale variations, and
at |NNLO| for renormalization ones), and it is discuss in the following
sections.

Factorization
~~~~~~~~~~~~~

Since the factorization scale variation is related only to the running of the
PDF, than it is not dependent on the process, apart from its input structure
(how many partons are present in the incoming state).

Thus the content of the coefficient functions is completely factorized in the
scale variations expressions.

They actually can be organized in powers of the perturbative coupling
:math:`a_s = \alpha_s(\mu_F) / 4\pi` and the logarithm of the factorization scale
:math:`L_M = \log(\mu_F^2 / Q^2)` (note the different definition of the log
with respect to :cite:`AbdulKhalek:2019ihb,nnlo-sv-singlet` that is the reason
of the different minus signs in the next expressions):

.. math::
  \textbf{C}_a(x, \alpha_s(\mu_R^2), L_M, L_R) \stackrel{\mu_R = \mu_F}{=}
  \textbf{c}_a^{(0)}(x) + \sum_{l=1}^\infty a_s^l \left(\textbf{c}_a^{(l)}(x) +
  \sum_{m=1}^l \textbf{c}_a^{(l,m)}(x) L_M^m\right)

Where :math:`a` (:math:`= 1,2,3,L`) is the kind of structure functions considered.

Than the explicit coefficient functions can be computed from |DGLAP| and
:math:`\alpha_s` running (see :cite:`nnlo-sv-singlet,nnlo-sv-nonsinglet`),
resulting in process and kind independent elements (the actual anomalous
dimension of the two runnings) convolved with lower order coefficient
functions:

.. math::
  \textbf{c}_a^{(1,1)} &= -\textbf{c}_a^{(0)} \otimes \textbf{P}^{(0)}\\
  \textbf{c}_a^{(2,1)} &= -\textbf{c}_a^{(0)} \otimes \textbf{P}^{(1)} + \textbf{c}_a^{(1)} \otimes (\textbf{P}^{(0)} - \beta_0 \textbf{1})\\
  \textbf{c}_a^{(2,2)} &= \frac{1}{2} \textbf{c}_a^{(1,1)} \otimes (\textbf{P}^{(0)}- \beta_0 \textbf{1})\\
  \textbf{c}_a^{(3,1)} &= -\textbf{c}_a^{(0)} \otimes \textbf{P}^{(2)} + \textbf{c}_a^{(1)} \otimes (\textbf{P}^{(1)} - \beta_1 \textbf{1}) + \textbf{c}_a^{(2)} \otimes (\textbf{P}^{(0)} - 2 \beta_0 \textbf{1})\\
  \textbf{c}_a^{(3,2)} &= \frac{1}{2} \left\{ \textbf{c}_a^{(1,1)} \otimes (\textbf{P}^{(1)}-\beta_1 \textbf{1}) + \textbf{c}_a^{(2,1)} \otimes (\textbf{P}^{(0)} - 2 \beta_0 \textbf{1}) \right\}\\
  \textbf{c}_a^{(3,3)} &= -\frac{1}{3} \textbf{c}_a^{(2,2)} \otimes (\textbf{P}^{(0)}- 2 \beta_0 \textbf{1})\\

Where :math:`\beta_k` are the coefficient of the :math:`a_s` beta function (pay
attention to the **normalization**: they are not the ones for the beta function
of :math:`\alpha_s`) and :math:`\textbf{P}^{(k)}` are the terms of the
perturbative expansion of the Altarelli-Parisi splitting functions (again
normalized in :math:`a_s`). Note that when converting the splitting functions to
the anomalous dimensions, following the |eko| definition, one gets a minus sign.

.. important::
  The equations above have to be read as *vectorial*, indeed the both the
  coefficient functions are vectors and the splitting functions are matrices.
  The basis can be decomposed in two parts, strictly related to the `evolution
  basis <https://eko.readthedocs.io/en/latest/theory/FlavorSpace.html#evolution-basis>`_:

  - the *non-singlet* part: there are three distinct elements for non-singlet, the
    so called :math:`ns,+`, :math:`ns,-`, and :math:`ns,v`, but in this sector
    splitting functions are completely diagonal
  - the *singlet* part: there are two elements, the quark singlet, :math:`q`,
    and the gluon, :math:`g`, but the splitting functions contain non-vanishing
    off-diagonal elements

  In other context this is called the `anomalous dimension basis
  <https://eko.readthedocs.io/en/latest/theory/FlavorSpace.html#operator-anomalous-dimension-basis>`_,
  since the *splitting functions* are known as *anomalous dimensions* when
  written in :math:`N`-space.

Notice that even if the equations have a nice structure when presented *nested*
- i.e. the coefficients are functions of the raw ones :math:`\textbf{c}^{(l)}_a`,
but also of the other scale-variations coefficients :math:`\textbf{c}^{(l,m)}_a` -
they may be completely inlined as functions of the raw ones (actually the
structure derives from the exponentiation procedure done by resummation in the
runnings).

Renormalization
~~~~~~~~~~~~~~~

It is related to the only running of the coupling :math:`\alpha_s(\mu_R^2)`,
with respect to a further different scale :math:`\mu_R^2`.

For this reason the easiest variable in which to express the new contribution is
actually :math:`L_R = \log(\mu_R^2/\mu_F^2)` (note the different definition of the log
with respect to :cite:`AbdulKhalek:2019ihb,nnlo-sv-singlet` that is the reason
of the different minus signs in the next expressions), that measures the discrepancy of
the new scale with respect to the one already considered, and they are expressed
on top of the expressions built in the previous paragraph:

.. math::
  \textbf{C}_a^{(2)}(x, L_M, L_R) &= \textbf{C}_a^{(2)}(x, L_M, 0) + \beta_0 L_R \textbf{C}_a^{(1)}(x, L_M)\\
  \textbf{C}_a^{(3)}(x, L_M, L_R) &= \textbf{C}_a^{(3)}(x, L_M, 0) + 2 \beta_0 L_R \textbf{C}_a^{(2)}(x, L_M, 0) + \{\beta_1 L_R + \beta_0^2 L_R^2\} \textbf{C}_a^{(1)}(x, L_M)

The vectorial character of the equations in this case is present but trivial (no
off-diagonal contribution, since :math:`\beta_k` are channel independent
scalars) and the contribution starts to be non-trivial only at |NNLO| |DIS|.

Procedures
----------

- **scheme A**: it requires a refit for the determination of the scale
  variations.
- **scheme B**: it does involve the evolution, so it resums the effect of the
  scale variation, see |eko|'s `scale variations docs
  <https://eko.readthedocs.io/en/latest/theory/pQCD.html#scale-variations>`_.
- **scheme C**: varying the scales in the context of |PDF| determination only in
  the coefficient functions corresponds to scheme C in
  :cite:`AbdulKhalek:2019ihb`.
